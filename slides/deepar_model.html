<section class="deepar-model-slide" data-menu-title="DeepAR Model Slide">
  <div class="slide-container">
    <div class="container-fluid d-flex align-items-center">
      <div class="row d-flex align-items-center g-5">
        <!-- Figure with Symbol Table below -->
        <div class="col-5">
          <figure class="figure">
            <img src="src/img/DeepAR_architecture.png" alt="DeepAR model architecture"
              class="img-fluid mx-auto figure-image img-thumbnail">
            <figcaption class="figure-caption mb-2">DeepAR Model Architecture Diagram&NoBreak;<span class="citation"
                data-ref="salinas_DeepARProbabilisticForecasting_2020"></span>.
            </figcaption>
          </figure>
        </div>
        <!-- Key Explanations -->
        <div class="col-7 fragment">
          <h3>DeepAR Model Specifics</h3>
          <ul>
            <li><strong>Autoregressive RNN:</strong> Leverages LSTM cells to model temporal dependencies using:</li>
          </ul>

          <!-- Centered Equations -->
          <div class="equation">
            \( h_{i,t} = h(h_{i,t-1}, z_{i,t-1}, x_{i,t}, \Theta) \)
          </div>

          <ul>
            <li><strong>Negative Binomial Distribution:</strong> Models count data effectively, discrete distribution to
              find number of trials needed to achieve a number of successes</li>
          </ul>

          <div class="equation">
            \( p_{NB}(z| \mu, \alpha) = \frac{\Gamma(z + \frac{1}{\alpha})}{\Gamma(z + 1)\Gamma(\frac{1}{\alpha})}
            \cdot \left( \frac{1}{1 + \alpha \mu} \right)^{\frac{1}{\alpha}}
            \cdot \left( \frac{\alpha \mu}{1 + \alpha \mu} \right)^{z} \)
          </div>
          <!-- <p>Describes the likelihood of observing \( z \) given \( \mu \) and \( \alpha \). E.g., if we are modeling
            daily sales data, \( z \) could be the number of
            sales on a particular day, \( \mu \) could be the average daily sales, and \( \alpha \) controls the
            variance in
            sales.</p> -->

          <!-- Symbol Table -->
          <table class="booktabs-table mt-5">
            <caption class="table-caption">Symbols used in the DeepAR Model.</caption>
            <thead>
              <tr>
                <th>Symbol</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>\( h \)</td>
                <td>Hidden state vector</td>
              </tr>
              <tr>
                <td>\( z \)</td>
                <td>Observed value at time <em>t</em></td>
              </tr>
              <tr>
                <td>\( x \)</td>
                <td>Covariates or external factors</td>
              </tr>
              <tr>
                <td>\( \Theta \)</td>
                <td>Model parameters</td>
              </tr>
              <tr>
                <td>\( \mu, \alpha \)</td>
                <td>Parameters of the distributions</td>
              </tr>
              <tr>
                <td>\( \Gamma \)</td>
                <td>Gamma function used in the distribution</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="distributions-slide" data-menu-title="DeepAR Distributions Slide">
  <div class="slide-container">
    <h3>Gaussian and Negative Binomial Distributions</h3>
    <div class="fig-container container-fluid d-flex align-items-center" data-preload
      data-file="src/d3/distributions.html" data-style="height: 100%"></div>
  </div>
</section>

<section class="dar-training-slide" data-menu-title="DeepAR Training Slide">
  <div class="slide-container">
    <div class="container d-flex flex-column py-4">
      <div class="row">
        <div class="col">
          <h2>DeepAR Training</h2>
          <ul class="list-group">
            <li class="fragment mt-3">
              <strong>Input Data Preparation:</strong>
              <div>Sliding window approach transforms historical data into training examples, allowing the model to
                learn from long-term and short-term trends.</div>
            </li>
            <li class="fragment mt-3">
              <strong>Loss Function:</strong>
              <div>Maximize log-likelihood for accurate parameter estimation. The loss function is:
                <div class="equation">
                  \( L = \sum_{i=1}^{N} \sum_{t=t_{0}}^{T} \log p(z_{i,t} \mid \theta(h_{i,t})). \)
                </div>
                where:
                <ul>
                  <li>\(N\) is the number of time series.</li>
                  <li>\(t_{0}\) is the starting point of the prediction window.</li>
                  <li>\(p(z_{i,t} \mid \theta)\) is the likelihood function for series \(i\) at time \(t\).</li>
                  <li>\(h\) represents the state of the recurrent neural network (RNN).</li>
                </ul>
              </div>
            </li>
            <li class="fragment mt-3">
              <strong>Optimization:</strong>
              <div>The Adam optimizer with early stopping ensures efficient learning by minimizing the loss function via
                stochastic gradient descent.</div>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="dar-scale-covariates-slide" data-menu-title="DeepAR Scale and Covariates Slide">
  <div class="slide-container">
    <div class="container d-flex flex-column py-4">
      <div class="row">
        <h2>Scale Handling and Covariates</h2>
        <div class="col-7">
          <ul class="list-group">
            <li class="fragment mt-3">
              <strong>Scale Handling:</strong>
              <div>Scaling normalizes the input for each time series using an item-specific factor:
                <div class="equation">
                  \( \nu_{i} = 1 + \frac{1}{t_{0}} \sum_{t=1}^{t_{0}} z_{i,t}. \)
                </div>
                <p class="text-center align-items-center my-2">
                  <svg class="my-2" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" id="pie-chart-icon">
                    <use href="../../src/icons/bootstrap-icons.svg#pie-chart"></use>
                  </svg>
                  <br>
                  <em>Normalization</em> &amp; <em>Weighted sampling</em>
                </p>
              </div>
            </li>
            <li class="fragment mt-3">
              <strong>Covariates:</strong>
              <div>Covariates provide crucial contextual information to DeepAR. They include:
                <ul>
                  <li><strong>Item-Specific:</strong> Product categories and item attributes.</li>
                  <li><strong>Time-Dependent:</strong> Temporal attributes like day-of-week, month-of-year, and
                    special events.</li>
                </ul>
                <p class="text-center align-items-center my-2">
                  <svg class="my-2" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" id="people-icon">
                    <use href="../../src/icons/bootstrap-icons.svg#people"></use>
                  </svg>
                  <br>
                  <em>External effects</em> &amp; <em>Relationships</em>
                </p>
              </div>
            </li>
          </ul>
        </div>
        <div class="col-5 text-center align-items-center">
          <figure class="figure">
            <img src="src/img/DAR_power_law_demand.svg" alt="Scale-Free Distribution"
              class="img-fluid mx-auto figure-image img-thumbnail">
            <figcaption class="figure-caption mb-2">Scale-Free Distribution for Time Series Data.</figcaption>
          </figure>
        </div>
      </div>
    </div>
  </div>
</section>